graph TB
    subgraph "Code Repository"
        A[Source Code Files]
        B[Documentation]
        C[README/Config Files]
    end

    subgraph "Preprocessing Layer"
        D[Code Parser & Chunker]
        E[AST Analyzer]
        F[Metadata Extractor]
        G[Dependency Mapper]
    end

    subgraph "Embedding Layer"
        H[EmbeddingGamma Model<br/>Docker Container]
        I[Batch Processor]
    end

    subgraph "Vector Database"
        J[Qdrant<br/>Docker Container]
        K[Collections:<br/>- Functions<br/>- Classes<br/>- Documentation]
        L[Payload Storage:<br/>- Code snippets<br/>- File paths<br/>- Metadata]
    end

    subgraph "Retrieval Layer"
        M[Query Processor]
        N[Hybrid Search:<br/>- Vector similarity<br/>- Keyword search<br/>- Metadata filters]
        O[Reranker]
    end

    subgraph "Generation Layer"
        P[Mistral Code Model]
        Q[Context Builder]
        R[Prompt Constructor]
    end

    A --> D
    B --> D
    C --> D
    D --> E
    D --> F
    E --> G
    F --> I
    G --> I
    I --> H
    H --> J
    J --> K
    J --> L
    
    M --> N
    N --> K
    N --> L
    N --> O
    O --> Q
    Q --> R
    R --> P
    
    style H fill:#e1f5ff
    style J fill:#e1f5ff
    style P fill:#ffe1e1